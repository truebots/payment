  
  <!DOCTYPE html>
  <html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>TrueBots</title>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <link rel="icon" href="img/Fevicon.png" type="image/png">
    <link rel="stylesheet" href="vendors/bootstrap/bootstrap.min.css">
    <link rel="stylesheet" href="vendors/fontawesome/css/all.min.css">
    <link rel="stylesheet" href="vendors/themify-icons/themify-icons.css">
    <link rel="stylesheet" href="vendors/linericon/style.css">
    <link rel="stylesheet" href="vendors/owl-carousel/owl.theme.default.min.css">
    <link rel="stylesheet" href="vendors/owl-carousel/owl.carousel.min.css">
    <link rel="stylesheet" href="vendors/nice-select/nice-select.css">
    <link rel="stylesheet" href="vendors/nouislider/nouislider.min.css">
    
    <link rel="stylesheet" href="css/style.css">
    <script language="JavaScript" src="md5.js"></script>




<script>
            (function(d, s, id){
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "https://connect.facebook.net/en_US/messenger.Extensions.js";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'Messenger'));


function obtenerValorParametro(sParametroNombre) {
          var sPaginaURL2 = decodeURIComponent(document.location.href);
          
          var sPaginaURL= sPaginaURL2.split("?");
          var sURLVariables = sPaginaURL[1].split('&');
            for (var i = 0; i < sURLVariables.length; i++) {
              var sParametro = sURLVariables[i].split('=');
              if (sParametro[0] == sParametroNombre) {
                return sParametro[1];
              }
      }
      return null;
      }


</script>



  </head>
  <body>
  
	<!-- ================ start banner area ================= -->	
	<section class="blog-banner-area" id="category">
		<div class="container h-100">
			<div class="blog-banner">
				<div class="text-center">
          <h1 >Order Confirmation</h1>
					<nav aria-label="breadcrumb" class="banner-breadcrumb">
            <ol class="breadcrumb">
              <li class="breadcrumb-item"><a href="#">Home</a></li>
              <li class="breadcrumb-item active" aria-current="page">Shop Category</li>
            </ol>
          </nav>
				</div>
			</div>
    </div>
	</section>
	<!-- ================ end banner area ================= -->
  
  <!--================Order Details Area =================-->
  <section class="order_details section-margin--small">
    <div class="container">
      <p class="text-center billing-alert">Thank you. Your order has been received.</p>
      <div class="row mb-5">
        <div class="col-md-6 col-xl-4 mb-4 mb-xl-0">
          <div id="o1" class="confirmation-card">
              
          </div>
        </div>
        <div class="col-md-6 col-xl-4 mb-4 mb-xl-0">
          <div  id="o2" class="confirmation-card">
              
          </div>
        </div>
        
      </div>
      
  </section>
  <!--================End Order Details Area =================-->

 <!--================Cart Area =================-->

 <div class="container">
     
      <div  class="cart_inner">
                <div class="table-responsive">
                  <table id="productTable"  class="table">
                    <thead>
                      <tr>
                        <th scope="col">Product</th>
                        <th scope="col">Price</th>
                        <th scope="col">Quantity</th>
                        <th scope="col">Total</th>
                        </tr>
                      </thead>
                      <tbody>
                            </tbody>
                          </table>
                </div>
               
                <div class="order_details_table">
                  <h2>Order Details</h2>
                  <div  class="table-responsive">
                    <div id="o3">
                        <table id="order3" class="table">
                          <thead>
                            </thead>
                            <tbody>
                              
                            </tbody>
                          </table>
                  
                    </div>
                  </div>
                </div>
                <br>
               <center>
                 <section  style="float: center">    
                
                    <form method="post" action="https://sandbox.checkout.payulatam.com/ppp-web-gateway-payu/">
                      <input id="merchantId" name="merchantId"    type="hidden"  value="508029"   >
                      <input id="accountId" name="accountId"     type="hidden"  value="512321" >
                      <input id="description" name="description"   type="hidden"  value="Test PAYU"  >
                      <input id="referenceCode" name="referenceCode" type="hidden"  value="TestPayU" >
                      <input id="amount" name="amount"        type="hidden"  value="20000"   >
                      <input id="tax" name="tax"           type="hidden"  value="3193"  >
                      <input id="taxReturnBase" name="taxReturnBase" type="hidden"  value="16806" >
                      <input id="currency" name="currency"      type="hidden"  value="COP" >
                      <input id="signature" name="signature"     type="hidden"  value="7ee7cf808ce6a39b17481c54f2c57acc"  >
                      <input id="test" name="test"          type="hidden"  value="1" >
                      <input id="buyerEmail" name="buyerEmail"    type="hidden"  value="test@test.com" >
                      <input id="payerFullName" name="payerFullName"    type="hidden"  value="test@test.com" >
                      
                      <input id="confirmationUrl" name="confirmationUrl"    type="hidden"  value="http://www.test.com/confirmation" >
                      <input id="extra1" name="extra1"    type="hidden"  value="http://www.test.com/confirmation" >
                      <input id="extra2" name="extra2"    type="hidden"  value="http://www.test.com/confirmation" >
                      <input id="extra3" name="extra3"    type="hidden"  value="http://www.test.com/confirmation" >
                      
                      <input id="sub2" name="Submit"   class="button button-coupon"   onclick="myFunction2()"   type="submit"  value="Enviar" >
                    </form>
                   <button   class="button button-coupon" onclick="myFunction()">Cancelar</button>
                       


                </section> 
              </center>
                
             
              </div>
            
              <br>
          </div>
      </div>
      <script>

var query = {"e":obtenerValorParametro("extra")};
      var m= decodeURIComponent(atob(query.e).split('').map(function(c) {
        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
    }).join(''));
            var f=JSON.parse(m);
            var lista = document.getElementById("o1");
            console.log(f);
            var tax=(parseInt(f.tax)*parseInt(f.amount))/100;
            var amountcal=tax+parseInt(f.amount);
  
            
              
              ($.ajax({
                type: "GET",
                url: "https://us-central1-secure-potion-243418.cloudfunctions.net/ES-function-addPurchaseOrder?callback=?",
                data: {
                            extra: query.e
                            
                },
                dataType: "jsonp",
                crossDomain:true,
                        
                success: function(t) {
                  var query = {"e":obtenerValorParametro("extra")};
      var m= decodeURIComponent(atob(query.e).split('').map(function(c) {
        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
    }).join(''));
            var f=JSON.parse(m);
            var lista = document.getElementById("o1");
            console.log(f);
            var tax=(parseInt(f.tax)*parseInt(f.amount))/100;
            var amountcal=tax+parseInt(f.amount);
                    console.log(t);
                    document.getElementById("referenceCode").value = t.id;
                    var sig=f.apiKey+"~"+f.merchantId+"~"+t.id+"~"+amountcal+"~"+f.currency;
                    var signature=calcMD5(sig);
                    console.log("sig-"+signature);
                    document.getElementById("signature").value = signature;
                    
                    var query = {"e":obtenerValorParametro("extra")};
  m= decodeURIComponent(atob(query.e).split('').map(function(c) {
        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
    }).join(''));

        var f=JSON.parse(m);
                  
          
        var lista = document.getElementById("o1");
        console.log(f);
          var fe=f.date.split("T");
      
            lista.innerHTML="";
            lista.innerHTML +='<h3 class="billing-title">Order Info</h3>';
        lista.innerHTML +='<table class="order-table">';
            lista.innerHTML +="<tr>";
            lista.innerHTML +="<td>Order number</td>";
            lista.innerHTML +="<td>: 14567890</td>";
            lista.innerHTML +="</tr><br>";
            lista.innerHTML +="<tr>";
            lista.innerHTML +="<td>Date</td>";
            lista.innerHTML +="<td>: "+fe[0]+"</td>";
            lista.innerHTML +="</tr><br>";
            lista.innerHTML +="<tr>";
            lista.innerHTML +="<td>Total</td>";
            lista.innerHTML +="<td>: "+f.currency+" "+f.amount +"</td>";
            lista.innerHTML +="</tr><br>";
            lista.innerHTML +="<tr>";
            lista.innerHTML +="<td>Payment method</td>";
            lista.innerHTML +="<td>: Check payments</td>";
            lista.innerHTML +="</tr><br>";
            lista.innerHTML +="</table>";
            lista = document.getElementById("o2");
          
            
              
            lista.innerHTML="";
            lista.innerHTML +='<h3 class="billing-title">Billing Address</h3>';
            lista.innerHTML +='<table class="order-table">';
         
            lista.innerHTML +="<tr>";
              lista.innerHTML +="<td>Street</td>";
              lista.innerHTML +="<td>: "+f.user.address+"</td>";
              lista.innerHTML +=" </tr><br>";
              lista.innerHTML +="<tr>";
                lista.innerHTML +="<td>City</td>";
                lista.innerHTML +="<td>: "+f.user.city+"</td>";
                lista.innerHTML +="</tr><br>";
                lista.innerHTML +="<tr>";
                  lista.innerHTML +="<td>Country</td>";
                  lista.innerHTML +="<td>: "+f.user.country+"</td>";
                  lista.innerHTML +="</tr><br>";
                  lista.innerHTML +="<tr>";
                    lista.innerHTML +="<td>Postcode</td>";
                    lista.innerHTML +="<td>: "+f.user.postalcode+"</td>";
                    lista.innerHTML +="</tr><br>";
                    lista.innerHTML +="<tr>";
                    lista.innerHTML +="<td>Email</td>";
                    lista.innerHTML +="<td>: "+f.user.email+"</td>";
                    lista.innerHTML +="</tr><br>";
                    lista.innerHTML +="<tr>";
                    lista.innerHTML +="<td>Cellphone</td>";
                    lista.innerHTML +="<td>: "+f.user.tel+"</td>";
                    lista.innerHTML +="</tr><br>";
                    lista.innerHTML +="</table>";
      
var tax=(parseInt(f.tax)*parseInt(f.amount))/100;
var amountcal=tax+parseInt(f.amount);
document.getElementById("tax").value = tax;
document.getElementById("taxReturnBase").value = parseInt(f.amount);
document.getElementById("amount").value = amountcal;
                  
                  
  $("#order3 tbody").append(
    "<tr>"+"<td>"+"<h4>Subtotal</h4>"+"</td>"+"<td>"+"<h5></h5>"+"</td>"+"<td>"+
      "<p>"+f.currency+f.amount+"</p>"+"</td>"+"</tr>"+"<tr>"+"<td>"+"<h4>Shipping</h4>"+"</td>"+
        "<td>"+"<h5></h5>"+"</td>"+"<td>"+"<p>Flat rate: "+f.currency+tax+"</p>"+"</td>"+"</tr>"+"<tr>"
          +"<td>"+"<h4>Total</h4>"+"</td>"+"<td>"+"<h5></h5>"+"</td>"+"<td>"+"<h4>"+f.currency+amountcal+"</h4>"+
            "</td>"+"</tr>"
  );
         
   

                                        
                  for(var m=0; m<f.productos.length ; m++){

var total=parseInt(f.productos[m].price)*parseInt(f.productos[m].quantity);

                    $("#productTable tbody").append(
      "<tr>" +
        "<td>"+'<div class="media">'+'<div class="d-flex">'+
        '<img src="'+f.productos[m].image_url+'" alt="">'+"</div>"
        +'<div class="media-body">'+"<p>"+f.productos[m].title+"</p>"
        +"</div>"+"</div>"+"</td>" +
        "<td>"+"<h5>"+f.currency+f.productos[m].price+"</h5>"+"</td>" +
        "<td>"+"<h5>"+f.productos[m].quantity+"</h5>"+"</td>" +
        "<td>"+"<h5>"+f.currency+total+"</h5>"+"</td>" +
      "</tr>"
  );
                    



                  }
                  
                  
                  document.getElementById("merchantId").value = f.merchantId;
                  document.getElementById("accountId").value = f.accountId;
                  document.getElementById("description").value = f.description;
                  document.getElementById("currency").value = f.currency;
                  document.getElementById("buyerEmail").value = f.buyerEmail;
                  document.getElementById("payerFullName").value = f.payerFullName;
                  document.getElementById("confirmationUrl").value = f.confirmationUrl;
                  document.getElementById("extra1").value = f.googlesheetId;
                  document.getElementById("extra2").value = f.broadcastId;
                  document.getElementById("extra3").value = f.muserID+"-"+f.botId;
                  

                  document.getElementById("sub2").click();
 
       


                },
                error: function(t) {
                    console.log(t);
                    


                }
            }));
      
  
</script>



